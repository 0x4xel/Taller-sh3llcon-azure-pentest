// Obtengo la subscripcion actual
data "azurerm_subscription" "current" {}

// Obtengo la configuraci√≥n actual 
data "azurerm_client_config" "current" {}

// Obtengo el tenant actual
data "azuread_domains" "tenant" {
  only_initial = true
}

// Obtengo el usuario actual. Se usa para obtener el correo
data "azuread_user" "current_user" {
  object_id = data.azurerm_client_config.current.object_id
}

// Creo el resource group de wordpress
resource "azurerm_resource_group" "res-0" {
  location = "West Europe"
  name     = "${random_password.prefix_wordpress.result}-wordpress-rg"
}

// Creo el resource group de brock
resource "azurerm_resource_group" "brock" {
    name="${local.prefix}-brock"
    location = "North Europe"
}

// Creo el resource group de misty
resource "azurerm_resource_group" "misty" {
    name="${local.prefix}-misty"
    location = "North Europe"
}

// --- Azure AD

// Creo usuario Azure AD brock
resource "azuread_user" "brock" {
  user_principal_name = local.brock_principal_name
  display_name        = "brock"
  password            = "2f34g45hh5hgfsr543#" // hardcoded para el CTF

}

// Creo usuario Azure AD misty
resource "azuread_user" "misty" {
  user_principal_name = local.misty_principal_name
  display_name        = "misty"
  password            = random_password.user_misty_password.result
}
